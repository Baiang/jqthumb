/*
	Copyright (c) 2013-2014 Tho Pak Cheong
	Version: 1.6.1 (23-MAY-2014)
	Dual licensed under the MIT and GPL licenses.
	Requires: jQuery v1.3 or later
*/
(function(e,t,n,r){function a(t,n){this.element=t;this.settings=e.extend({},o,n);this.settings.width=this.settings.width.toString().replace(/px/g,"");this.settings.height=this.settings.height.toString().replace(/px/g,"");this.settings.position.top=this.settings.position.top.toString().replace(/px/g,"");this.settings.position.left=this.settings.position.left.toString().replace(/px/g,"");this._defaults=o;this._name=s;if(typeof n=="string"){if(n.toLowerCase()=="kill"){this.kill(this.element)}}else{this.init()}}var s="jqthumb",o={classname:"jqthumb",width:100,height:100,position:{top:"50%",left:"50%"},source:"src",showoncomplete:true,before:function(){},after:function(){},done:function(){}},u={elemCounter:0,totalElems:0,inputElems:{},outputElems:[]};a.prototype={init:function(){if(this.support_css3_attr("backgroundSize")==false){this.nonCss3Supported_method(this.element,this.settings)}else{this.css3Supported_method(this.element,this.settings)}},kill:function(t){if(e.data(t,"plugin_"+s)){if(e(t).prev().data("plugin")!==s){console.error("We could not find the element created by jqthumb. It is probably due to one or more element has been added right before the image element after the plugin initialization, or it was removed.");return false}e(t).prev().remove();e(t).removeAttr("style");if(typeof e(t).data("original-styles")!=="undefined"){e(t).attr("style",e(t).data("original-styles"))}if(typeof e(t).data("original-styles")!=="undefined"){e(t).removeData("original-styles")}if(typeof e(t).data("plugin_"+s)!=="undefined"){e(t).removeData("plugin_"+s)}}},nonCss3Supported_method:function(t,n){n.before.call(t,t);var r=this;e(t).data("original-styles",e(t).attr("style"));e(t).hide();e(t).one("load",function(){r.checkSrcAttrName(t,n);var i=e("<img/>").attr("src",e(t).attr("src"));e(i).load(function(){var o={obj:i,size:{width:this.width,height:this.height}},u=r.percentOrPixel(n.width),a=r.percentOrPixel(n.height),f=e("<div />");e(f).insertBefore(e(t)).append(e(o.obj)).css({position:"relative",overflow:"hidden",width:u=="%"?n.width:n.width+"px",height:a=="%"?n.height:n.height+"px"}).data("plugin",s);if(o.size.width>o.size.height){e(o.obj).css({width:"auto","max-height":99999999,"min-height":0,"max-width":99999999,"min-width":0,height:e(o.obj).parent().height()+"px"});var l=e(o.obj).height()/e(o.obj).width();if(e(o.obj).width()<e(o.obj).parent().width()){e(o.obj).css({width:e(o.obj).parent().width(),height:parseFloat(e(o.obj).parent().width()*l)})}}else{e(o.obj).css({width:e(o.obj).parent().width()+"px","max-height":99999999,"min-height":0,"max-width":99999999,"min-width":0,height:"auto"});var l=e(o.obj).width()/e(o.obj).height();if(e(o.obj).height()<e(o.obj).parent().height()){e(o.obj).css({width:parseFloat(e(o.obj).parent().height()*l),height:e(o.obj).parent().height()})}}posTop=r.percentOrPixel(n.position.top)=="%"?n.position.top:n.position.top+"px";posLeft=r.percentOrPixel(n.position.left)=="%"?n.position.left:n.position.left+"px";e(o.obj).css({position:"absolute",top:posTop,"margin-top":function(){if(r.percentOrPixel(n.position.top)=="%"){return"-"+parseFloat(e(o.obj).height()/100*n.position.top.slice(0,-1))+"px"}},left:posLeft,"margin-left":function(){if(r.percentOrPixel(n.position.left)=="%"){return"-"+parseFloat(e(o.obj).width()/100*n.position.left.slice(0,-1))+"px"}}});e(f).hide().addClass(n.classname);if(n.showoncomplete==true){e(f).show()}n.after.call(t,e(f));r.updateGlobal(t,e(f),n)}).each(function(){e(i).load()})}).each(function(){e(t).load()})},css3Supported_method:function(t,n){n.before.call(t,t);var r=this;e(t).data("original-styles",e(t).attr("style"));e(t).hide();e(t).one("load",function(){var i=r.percentOrPixel(n.width),o=r.percentOrPixel(n.height),u,a;u=e("<div/>").css({width:i=="%"?n.width:n.width+"px",height:o=="%"?n.height:n.height+"px",display:"none"}).addClass(n.classname).data("plugin",s);a=e("<div/>").css({width:"100%",height:"100%","background-image":'url("'+e(t).attr(n.source)+'")',"-ms-filter":'"progid:DXImageTransform.Microsoft.AlphaImageLoader(src="'+e(t).attr(n.source)+'",sizingMethod="scale")',"background-repeat":"no-repeat","background-position":function(){var e=r.percentOrPixel(n.position.top)=="%"?n.position.top:n.position.top+"px",t=r.percentOrPixel(n.position.left)=="%"?n.position.left:n.position.left+"px";return e+" "+t}(),"background-size":"cover"}).appendTo(e(u));e(u).insertBefore(e(t));if(n.showoncomplete==true){e(u).show()}r.checkSrcAttrName(t,n);n.after.call(t,e(u));r.updateGlobal(t,e(u),n)}).each(function(){e(t).load()})},updateGlobal:function(t,n,r){u.outputElems.push(e(n));u.elemCounter=u.elemCounter+1;if(u.elemCounter==u.totalElems){r.done.call(t,u.outputElems)}},checkSrcAttrName:function(t,n){if(n.source!="src"&&(typeof e(t).attr("src")=="undefined"||e(t).attr("src")=="")){e(t).attr("src",e(t).attr(n.source))}},percentOrPixel:function(e){e=e.toString();if(e.match("px$")||e.match("PX$")||e.match("pX$")||e.match("Px$")){return"px"}else if(e.match("%$")){return"%"}},support_css3_attr:function(){var e=n.createElement("div"),t="Khtml Ms O Moz Webkit".split(" "),r=t.length;return function(n){if(n in e.style)return true;n=n.replace(/^[a-z]/,function(e){return e.toUpperCase()});for(i=0;i<t.length;i++){if(t[i]+n in e.style){return true}}return false}}()};e.fn[s]=function(t){if(e.isFunction(e.fn.addBack)==false){e.fn.extend({addBack:function(e){return this.add(e==null?this.prevObject:this.prevObject.filter(e))}})}var n=e(this).find("*").addBack();u.elemCounter=0;u.outputElems=[];u.inputElems=e(n);u.totalElems=e(n).length;return this.each(function(){if(typeof t=="string"){new a(this,t)}else{if(!e.data(this,"plugin_"+s)){e.data(this,"plugin_"+s,new a(this,t))}else{new a(this,"kill");e.data(this,"plugin_"+s,new a(this,t))}}})}})(jQuery,window,document)